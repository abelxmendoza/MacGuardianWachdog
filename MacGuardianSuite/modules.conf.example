# MacGuardian Module Configuration
# Copy this to ~/.macguardian/modules.conf and customize

# ============================================
# Collector Modules
# ============================================

[collectors.fsevents]
enabled = true
paths = /Users, /Applications, /System/Library
exclude = .git, node_modules, .DS_Store, Library/Caches, Library/Logs

[collectors.unified_logging]
enabled = true
predicates = subsystem:com.apple.security, subsystem:com.apple.network, subsystem:com.apple.EndpointSecurity

[collectors.endpoint_security]
enabled = false
# Note: Requires System Extension and Full Disk Access
buffer_size = 1000
filters = process.exec, file.write, network.connect

[collectors.network]
enabled = true
# Monitor network connections
interfaces = en0, en1

# ============================================
# Output Modules
# ============================================

[outputs.local]
enabled = true
format = jsonl
path = ~/.macguardian/events
max_file_size = 10485760

[outputs.splunk]
enabled = false
url = https://splunk.example.com:8088
token = your-hec-token-here
index = macguardian
batch_size = 100

[outputs.elasticsearch]
enabled = false
url = http://localhost:9200
index = macguardian-%{+YYYY.MM.dd}
username = 
password = 
batch_size = 100

[outputs.webhook]
enabled = false
url = https://your-webhook-endpoint.com/events
token = your-webhook-token
batch_size = 50

# ============================================
# Event Bus Configuration
# ============================================

[event_bus]
queue_size = 10000
buffer_dir = ~/.macguardian/event_buffer
flush_interval = 1.0
batch_size = 100

